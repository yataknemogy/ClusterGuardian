# ClusterGuardian

ClusterGuardian — это приложение на основе Spring Boot, предназначенное для управления и мониторинга кластерных узлов. Приложение включает функции создания резервных копий базы данных, восстановления данных и управления кластерными узлами через REST API.

## Требования

- Docker и Docker Compose
- Java 17
- Gradle
- PostgreSQL 13

## Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/yataknemogy/ClusterGuardian.git
cd ClusterGuardian
```

### 2. Настройка переменных окружения
Убедитесь, что переменные окружения правильно настроены в `docker-compose.yml` и `application.properties`.

### 3. Сборка и запуск с использованием Docker

Для сборки и запуска приложения в Docker выполните следующие команды:

`
docker-compose up --build
`

### 4. Доступ к приложению

Приложение будет доступно по адресу  `http://localhost:8080`.

## Использование

### API-эндпоинты

- Кластерные узлы:
    - `GET /api/nodes`: Получить все кластерные узлы
    - `POST /api/nodes`: Добавить новый кластерный узел
    - `GET /api/nodes/{id}`: Получить кластерный узел по ID
    - `PUT /api/nodes/{id}`: Обновить кластерный узел по ID
    - `DELETE /api/nodes/{id}`: Удалить кластерный узел по ID

-  Резервное копирование:
    - `POST /api/backup/create`: Создать резервную копию базы данных
     - `POST /api/backup/restore`: Восстановить базу данных из резервной копии

## WebSocket-эндпоинты
- Обновления статуса узлов:
    - `ws://localhost:8080/ws/node-status`: Подписаться на обновления статуса кластерных узлов в режиме реального времени.

WebSocket-соединение позволяет клиентам получать обновления в реальном времени всякий раз, когда статус кластерного узла изменяется.

## Тестирование

### Модульные тесты

Проект включает модульные тесты, написанные с использованием JUnit и Mockito. Чтобы запустить их, используйте: 

`./gradlew test`.

### WebSocket Tests

Функциональность WebSocket может быть протестирована с использованием предоставленных модульных тестов в классе ClusterNodeWebSocketTest. Убедитесь, что приложение запущено, и выполните тесты:
`
./gradlew test
`

### Docker-тесты

Чтобы проверить функциональность приложения внутри контейнеров, убедитесь, что все контейнеры запущены, и выполните тесты подключения к базе данных и основные запросы к API.

## Отладка

Чтобы включить режим отладки, добавьте следующее в  `application.properties`:

```
logging.level.root=DEBUG
```

Или запустите приложение с помощью следующей команды:

`
./gradlew bootRun --args='--debug'
`

## Развертывание

Приложение может быть развернуто на любом сервере, поддерживающем Docker, или в кластере Kubernetes.

## Лицензия

Этот проект лицензирован по лицензии MIT — подробности см. в файле [LICENSE](/LICENSE.md).

## Читать на других языках

[EN](/README.md) | [RU](README_RU.md) | [FR](README_FR.md) | [JP](README_JP.md) | [DE](README_DE.md) | [CH](README_CH.md) | [KR](README_KR.md)